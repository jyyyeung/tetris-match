<!DOCTYPE html>
<html>
    <head>
        <title>Tetris Match</title>
        <!-- JQuery -->
        <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
        <!-- Fonts -->
        <link
            href="https://fonts.cdnfonts.com/css/public-pixel"
            rel="stylesheet"
        />
        <!-- Stylesheets -->
        <link href="css/style.css" rel="stylesheet" />
    </head>

    <body>
        <!-- Chatroom container -->
        <div
            id="container"
            class="col"
            content="width=device-width, initial-scale=1"
        >
            <!-- <div id="header" class="row"></div> -->
            <div id="homepage" class="row">
                <div
                    id="home-panel"
                    class="col"
                    content="width=device-width, initial-scale=1"
                >
                    <!-- Login Page Game Title -->
                    <div id="title" class="col">Tetris Match</div>
                    <div class="col">
                        <!-- START: Landing Page buttons -->
                        <div class="row before-login">
                            <button class="homepage-buttons" id="login-button">
                                Login
                            </button>
                        </div>
                        <div class="row before-login">
                            <button
                                class="homepage-buttons"
                                id="register-button"
                            >
                                Register
                            </button>
                        </div>
                        <div class="row after-login">
                            <button class="homepage-buttons" id="match-button">
                                Match
                            </button>
                        </div>
                        <div class="row after-login">
                            <button
                                class="homepage-buttons"
                                id="profile-button"
                            >
                                Profile
                            </button>
                        </div>
                        <div class="row">
                            <button
                                class="homepage-buttons"
                                id="howtoplay-button"
                            >
                                How to Play
                            </button>
                        </div>
                        <!-- END: Landing Page buttons -->
                    </div>
                </div>
                <!-- home page side panel -->
                <div
                    id="home-side-panel"
                    class="col"
                    content="width=device-width, initial-scale=1"
                >
                    <div class="before-login">
                        <!-- START: Sign in form -->
                        <form id="signin-form" class="col">
                            <div class="caption">SIGN IN WITH YOUR ACCOUNT</div>
                            <div class="spacer-0"></div>
                            <input
                                id="signin-username"
                                placeholder="Enter your username"
                            />
                            <input
                                id="signin-password"
                                type="password"
                                placeholder="Enter your password"
                            />
                            <div class="spacer-0"></div>
                            <button type="submit">Sign In</button>
                            <div
                                id="signin-message"
                                class="warning center"
                            ></div>
                            <div class="spacer-grow"></div>
                        </form>
                        <!-- END: Sign in form -->
                        <!-- START: Register form -->
                        <form id="register-form" class="col">
                            <div class="caption">REGISTER AN ACCOUNT</div>
                            <div class="spacer-0"></div>
                            <input
                                id="register-username"
                                maxlength="10"
                                placeholder="Enter your username"
                            />
                            <select id="register-avatar">
                                <option value="">Select your avatar</option>
                            </select>
                            <input
                                id="register-name"
                                maxlength="16"
                                placeholder="Enter your name"
                            />
                            <input
                                id="register-password"
                                type="password"
                                placeholder="Enter your password"
                            />
                            <input
                                id="register-confirm"
                                type="password"
                                placeholder="Enter your password again"
                            />
                            <div class="spacer-0"></div>
                            <button type="submit">Register</button>
                            <div
                                id="register-message"
                                class="warning center"
                            ></div>
                        </form>
                        <!-- END: Register form -->
                    </div>
                    <!-- START: User profile -->
                    <div
                        id="user-panel"
                        class="col"
                        style="transform: scale(1.5)"
                    >
                        <div id="profile-header" class="row">
                            <div>Welcome!</div>
                            <div class="field-content row shadow">
                                <span class="user-avatar"></span>
                                <span class="user-name">-</span>
                            </div>
                            <!-- Login Button -->
                            <button id="signout-button" class="icon">
                                <span class="material-icons">logout</span>
                            </button>
                        </div>
                        <div
                            style="
                                gap: 20px;
                                display: flex;
                                flex-direction: column;
                            "
                        >
                            <div>
                                Number of users online:
                                <tspan id="num-of-users-online">0</tspan>
                            </div>
                            <div>
                                My best score: <br />
                                <div
                                    id="time-mode-best-score"
                                    style="margin: 6px 18px"
                                >
                                    Time Mode
                                    <tspan id="time-mode-score">0</tspan>
                                </div>
                                <div
                                    id="survival-mode-best-score"
                                    style="margin: 6px 18px"
                                >
                                    Survival Mode
                                    <tspan id="survival-mode-score">0</tspan>
                                </div>
                            </div>
                            <div>
                                Scoreboard position: <br />
                                <div
                                    id="time-mode-scoreboard-position"
                                    style="margin: 6px 18px"
                                >
                                    Time Mode
                                    <tspan id="time-mode-position">0</tspan>
                                </div>
                                <div
                                    id="survival-mode-scoreboard-position"
                                    style="margin: 6px 18px"
                                >
                                    Survival Mode
                                    <tspan id="survival-mode-position">0</tspan>
                                </div>
                            </div>
                            <div id="profile-scoreboard">
                                View Scoreboard:
                                <section class="tab row">
                                    <button
                                        id="time-mode-scoreboard-button"
                                        class="tablinks active"
                                        onclick="openScoreboard(event, 'time')"
                                    >
                                        Time Mode
                                    </button>
                                    <button
                                        id="survival-mode-scoreboard-button"
                                        class="tablinks"
                                        onclick="openScoreboard(event, 'survival')"
                                    >
                                        Survival Mode
                                    </button>
                                </section>
                                <div
                                    id="time-mode-scoreboard"
                                    class="scoreboard row tabcontent"
                                >
                                    <div class="col">
                                        <div>Position</div>
                                        <div>1</div>
                                        <div>2</div>
                                        <div>3</div>
                                        <div>4</div>
                                        <div>5</div>
                                        <div>6</div>
                                        <div>7</div>
                                        <div>8</div>
                                        <div>9</div>
                                        <div>10</div>
                                    </div>
                                    <div class="col scoreboard-playerlist">
                                        <!-- <div>Player</div> -->
                                    </div>
                                    <div class="col scoreboard-scorelist">
                                        <!-- <div>Score</div> -->
                                    </div>
                                </div>
                                <div
                                    id="survival-mode-scoreboard"
                                    class="scoreboard row tabcontent"
                                >
                                    <div class="col">
                                        <div>Position</div>
                                        <div>1</div>
                                        <div>2</div>
                                        <div>3</div>
                                        <div>4</div>
                                        <div>5</div>
                                        <div>6</div>
                                        <div>7</div>
                                        <div>8</div>
                                        <div>9</div>
                                        <div>10</div>
                                    </div>
                                    <div class="col scoreboard-playerlist">
                                        <!-- <div>Player</div> -->
                                    </div>
                                    <div class="col scoreboard-scorelist">
                                        <!-- <div>Score</div> -->
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <!-- START: How to play instructions -->
                    <div id="how-to-play">
                        <h1 style="color: cyan">ABOUT TETRIS®</h1>
                        Tetris® is the addictive puzzle game that started it
                        all, embracing our universal desire to create order out
                        of chaos. The Tetris game was created by Alexey Pajitnov
                        in 1984—the product of Alexey’s computer programming
                        experience and his love of puzzles. In the decades to
                        follow, Tetris became one of the most successful and
                        recognizable video games, appearing on nearly every
                        gaming platform available. This page is the destination
                        for free online 2-player tetris game.
                        <br />
                        <h1 style="color: cyan">OBJECTIVE</h1>
                        The goal of Tetris is to score as many points as
                        possible by clearing horizontal lines of Blocks. The
                        player must rotate, move, and drop the falling
                        Tetriminos inside the Matrix (playing field). Lines are
                        cleared when they are filled with Blocks and have no
                        empty spaces.
                        <br />
                        As lines are cleared, the level increases and Tetriminos
                        fall faster, making the game progressively more
                        challenging. If the Blocks land above the top of the
                        playing field, the game is over.
                        <br />
                        <h1 style="color: cyan">CONTROLS</h1>
                        <span style="white-space: pre-line; color: white">
                            Left/right arrow key - move left/right Up arrow key
                            - rotate Down arrow key - soft drop Z - hold
                        </span>
                    </div>
                    <!-- END: How to play instructions -->
                </div>
            </div>

            <div id="match-page">
                <div id="match-content-container">
                    <div class="col" id="match-page-init">
                        <button
                            id="create-private-game-button"
                            class="match-buttons"
                        >
                            Create Private Room
                        </button>
                        <button
                            id="join-private-game-button"
                            class="match-buttons"
                        >
                            Join Private Room
                        </button>
                        <button id="public-match-button" class="match-buttons">
                            Public Match
                        </button>
                    </div>
                    <div id="match-choose-gamemode" class="col">
                        <h1 style="position: absolute; top: 10%">
                            Choose game mode:
                        </h1>
                        <button id="time-mode-button" class="row match-buttons">
                            Time
                        </button>
                        <button
                            id="survival-mode-button"
                            class="row match-buttons"
                        >
                            Survival
                        </button>
                        <span
                            id="match-mode-description"
                            style="white-space: pre-line; color: white"
                        >
                        </span>
                    </div>
                    <div class="col" id="create-private-game-page">
                        <h1 class="row" style="top: 0%; position: absolute">
                            Your private room is created!
                        </h1>
                        <span
                            class="row"
                            style="white-space: pre-line; color: white"
                        >
                            Below is your generated invitation code. Share them
                            with someone and wait for he/she to join!
                        </span>
                        <input
                            id="created-room-id"
                            readonly="readonly"
                            type="text"
                            value="000000"
                            style="color: black; text-align: center"
                        />
                    </div>
                    <div id="join-private-game-page">
                        <div class="col">
                            <h1 class="row" style="top: 0%; position: absolute">
                                Join private room
                            </h1>
                            <span
                                class="row"
                                style="white-space: pre-line; color: white"
                            >
                                Enter an invitation code below.
                            </span>
                            <form id="join-room-form" class="col">
                                <input
                                    id="join-room-id"
                                    type="text"
                                    maxlength="6"
                                    style="color: black; text-align: center"
                                />
                                <div class="spacer-0"></div>
                                <button type="submit">Join Room</button>
                                <div
                                    id="join-room-message"
                                    class="warning center"
                                ></div>
                            </form>
                        </div>
                    </div>
                    <div id="public-match-page" class="col">
                        <h1 style="top: 0%" id="queue-timer">0:00</h1>
                        <span style="white-space: pre-line; color: white">
                            Matching players for you...
                        </span>
                    </div>
                </div>
                <button
                    class="row"
                    id="match-page-return"
                    style="bottom: 10%; position: absolute"
                >
                    return
                </button>
            </div>
            <!-- Tetris Match game container -->
            <div id="game-container" class="gamecol">
                <div id="game-container-bg-img"></div>

                <div class="gamerow">
                    <!-- START: Player Next Tetriminos  -->
                    <box id="player-next" class="next-panel"
                        >Next
                        <icon></icon>
                        <icon></icon>
                        <icon></icon>
                    </box>
                    <!-- END: Player Next Tetriminos  -->
                    <!-- START: Player Tetriminos holded  -->
                    <box
                        id="player-hold"
                        style="
                            /* left: 0;
                        transform-origin: top left;
                        margin-left: 10px; */
                            top: 42%;
                        "
                        >Hold
                        <icon></icon>
                    </box>
                    <!-- END: Player Tetriminos holded  -->
                    <!-- START: Player current score  -->
                    <box
                        style="
                            /* left: 0;
                        transform-origin: top left;
                        margin-left: 10px; */
                            bottom: 20%;
                            width: 148px;
                        "
                        >Score<br />
                        <tspan id="player-score">000</tspan>
                    </box>
                    <!-- END: Player current score  -->
                </div>

                <div class="gamecol">
                    <!-- Player Game Canvas -->
                    <canvas
                        id="player-canvas"
                        width="320px"
                        height="448px"
                        style="left: 160px"
                    ></canvas>
                </div>

                <!-- START: Time remaining  -->
                <div class="gamerow" style="left: 50%; display: flex; top: 10%">
                    <box style="padding: 10px; top: 10%"
                        >Time
                        <br />
                        <tspan id="time">000</tspan>
                    </box>
                    <!-- END: Time remaining  -->
                    <!-- START: Difficulty  -->
                    <box style="padding: 10px; top: 20%"
                        >Level
                        <br />
                        <tspan id="difficulty">000</tspan>
                    </box>
                </div>
                <!-- END: Difficulty  -->

                <div class="gamecol">
                    <!-- Opponent Game Canvas -->
                    <canvas
                        id="opponent-canvas"
                        width="320px"
                        height="448px"
                        style="right: 160px"
                    ></canvas>
                </div>
                <div class="gamerow">
                    <box
                        id="opponent-next"
                        class="next-panel"
                        style="
                            right: 0;
                            transform-origin: top right;
                            margin-right: 10px;
                        "
                        >Next
                        <icon></icon>
                        <icon></icon>
                        <icon></icon>
                    </box>
                    <!-- END: Opponent next Tetriminos -->
                    <!-- START: Opponent Tetriminos Holded -->
                    <box
                        id="opponent-hold"
                        style="
                            right: 0;
                            transform-origin: top right;
                            margin-right: 10px;
                            top: 42%;
                        "
                        >Hold
                        <icon></icon>
                    </box>
                    <!-- END: Opponent Tetriminos Holded -->
                    <!-- START: Opponent Score -->
                    <box
                        style="
                            right: 0;
                            transform-origin: top right;
                            margin-right: 10px;
                            bottom: 20%;
                            width: 148px;
                        "
                    >
                        Score<br />
                        <tspan id="opponent-score">000</tspan>
                    </box>
                </div>

                <!-- START: Opponent next Tetriminos -->

                <!-- END: Opponent Score -->

                <!-- <box>Next</box> -->

                <!-- <canvas width="854px" height="480px"></canvas> -->
                <!-- Game Start Display text -->
                <!-- <svg xmlns="http://www.w3.org/2000/svg" id="game-start">
                <defs>
                    <linearGradient id="title-fill" x1="0" y1="0" x2="0" y2="1">
                        <stop offset="0.2" stop-color="red" />
                        <stop offset="0.4" stop-color="yellow" />
                        <stop offset="0.6" stop-color="green" />
                        <stop offset="0.8" stop-color="purple" />
                    </linearGradient>
                </defs>
                <text id="game-title" x="50%" y="45%">GEM RUSH!</text>
                <text x="50%" y="60%">Click here to start the game</text>
            </svg> -->

                <!-- Game over display text -->
                <!-- <svg xmlns="http://www.w3.org/2000/svg" id="game-over" style="display: none">
                <defs>
                    <linearGradient id="game-over-fill" x1="0" y1="0" x2="0" y2="1">
                        <stop offset="0" stop-color="red" />
                        <stop offset="0.5" stop-color="yellow" />
                        <stop offset="1" stop-color="red" />
                    </linearGradient>
                </defs>
                <text x="50%" y="50%">
                    Time's up! You have collected
                    <tspan id="final-gems">0</tspan>
                    gem(s).
                </text>
            </svg> -->
            </div>

            <div id="gameover" class="col">
                <h1 id="gameover-title">GAME OVER</h1>
                <div id="gameover-stat" class="row">
                    <div class="col gameover-text">
                        <br />
                        <div>Score</div>
                        <div>Lines of Blocks</div>
                        <div>Tetris count</div>
                        <div>Time</div>
                    </div>
                    <div id="player-stat" class="col gameover-text">
                        <span class="user-avatar"></span>
                        <span class="user-name"></span>
                        <div>123</div>
                        <div>123</div>
                        <div>123</div>
                        <div>1:23</div>
                    </div>
                    <div id="opponent-stat" class="col gameover-text">
                        <span class="user-avatar"></span>
                        <span class="user-name"></span>
                        <div>123</div>
                        <div>123</div>
                        <div>123</div>
                        <div>1:23</div>
                    </div>
                </div>
                <div id="scoreboard-page" class="col">
                    <h1>SCOREBOARD</h1>
                    <div
                        class="row scoreboard"
                        style="transform: scale(0.7) translateY(-50px)"
                    >
                        <div class="col gameover-text">
                            <div>Position</div>
                            <div>1</div>
                            <div>2</div>
                            <div>3</div>
                            <div>4</div>
                            <div>5</div>
                            <div>6</div>
                            <div>7</div>
                            <div>8</div>
                            <div>9</div>
                            <div>10</div>
                        </div>
                        <div class="col gameover-text scoreboard-playerlist">
                            <div>Player</div>
                        </div>
                        <div class="col gameover-text scoreboard-scorelist">
                            <div>Score</div>
                        </div>
                    </div>
                </div>
                <div id="gameover-rematch" class="col">
                    <h1>Rematch?</h1>
                    <div class="row" style="gap: 50px">
                        <button id="rematch-button" class="row">Yes</button>
                        <button id="gameover-home-button" class="row">
                            No, return to homepage
                        </button>
                    </div>
                </div>
                <button
                    id="gameover-next"
                    style="bottom: 10%; position: absolute; display: none"
                >
                    next
                </button>
            </div>

            <!-- <div id="main-panel" class="row">
            <div id="chat-panel" class="col">
                <div id="chat-area" class="col"></div>
                <i>
                    <div id="show-typing"></div>
                </i>
                <form id="chat-input-form" autocomplete="off">
                    <input id="chat-input" placeholder="Enter your message"></input>
                </form>
            </div>

            <div id="online-users-panel" class="col">
                <div id="online-users-area" class="col"></div>
            </div>
        </div> -->
        </div>
        <!-- <div id="signin-overlay" class="overlay row">
        <div class="content shadow row">
            

            <div class="spacer-0"></div>

            
        </div> -->
        <!-- </div> -->
        <!-- </div> -->

        <script src="/socket.io/socket.io.min.js"></script>
        <script src="scripts/constants/socket_events.js"></script>
        <script src="scripts/socket.js"></script>
        <script src="scripts/sprites/sprite.js"></script>
        <script src="scripts/sprites/mino.js"></script>
        <script src="scripts/sprites/tetromino.js"></script>
        <script src="scripts/bounding_box.js"></script>
        <script src="scripts/control.js"></script>
        <script src="scripts/canvas.js"></script>
        <script src="scripts/ui.js"></script>
        <script src="scripts/auth/avatar.js"></script>
        <script src="scripts/auth/registration.js"></script>
        <script src="scripts/auth/authentication.js"></script>

        <script>
            $(function () {
                // Initialize the UI
                UI.initialize();

                // Validate the signin
                Authentication.validate(
                    () => {
                        //SignInForm.hide();
                        UserPanel.update(Authentication.getUser());
                        UserPanel.show();
                        $(".before-login").hide();
                        UI.renderSidePanel(3);
                        $(".after-login").show();

                        Socket.connect();
                    },
                    () => {
                        SignInForm.show();
                    }
                );
            });
            function openScoreboard(evt, mode) {
                var i, tabcontent, tablinks;
                tabcontent = document.getElementsByClassName("tabcontent");
                for (i = 0; i < tabcontent.length; i++) {
                    tabcontent[i].style.display = "none";
                }
                tablinks = document.getElementsByClassName("tablinks");
                for (i = 0; i < tablinks.length; i++) {
                    tablinks[i].className = tablinks[i].className.replace(
                        " active",
                        ""
                    );
                }
                document.getElementById(
                    mode + "-mode-scoreboard"
                ).style.display = "flex";
                evt.currentTarget.className += " active";
            }
        </script>
    </body>
</html>
